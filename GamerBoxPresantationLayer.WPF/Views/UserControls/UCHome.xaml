<UserControl x:Class="GamerBoxPresantationLayer.WPF.Classes.UCHome"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="1100">

    <Grid Background="{DynamicResource MainBackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Background="{DynamicResource PanelBackgroundBrush}" 
                Padding="20,10" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1">
            <DockPanel>
                <ToggleButton x:Name="btnToggleFilter" Click="btnToggleFilter_Click" 
                              Width="40" Height="35" Background="{DynamicResource BorderBrush}" 
                              Foreground="{DynamicResource PrimaryTextBrush}" BorderThickness="0" Margin="0,0,15,0">
                    <ToggleButton.Content>
                        <TextBlock Text="&#xE71C;" FontFamily="Segoe MDL2 Assets" FontSize="16"/>
                    </ToggleButton.Content>
                    <ToggleButton.Resources>
                        <Style TargetType="Border">
                            <Setter Property="CornerRadius" Value="5"/>
                        </Style>
                    </ToggleButton.Resources>
                    <ToggleButton.ToolTip>Filtreleri Göster/Gizle</ToggleButton.ToolTip>
                </ToggleButton>

                <TextBlock Text="Oyun Kütüphanesi" Foreground="{DynamicResource AccentBrush}" 
                           FontSize="18" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,20,0"/>

                <Border Background="{DynamicResource InputBackgroundBrush}" CornerRadius="5" Width="300" HorizontalAlignment="Right" DockPanel.Dock="Right">
                    <DockPanel>
                        <TextBlock Text="&#xE721;" FontFamily="Segoe MDL2 Assets" 
                                   Foreground="{DynamicResource MutedTextBrush}" VerticalAlignment="Center" Margin="10,0,5,0"/>
                        <TextBox Height="35" Background="Transparent" Foreground="{DynamicResource PrimaryTextBrush}" 
                                 BorderThickness="0" VerticalContentAlignment="Center" Padding="5" FontSize="14"
                                 Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                 Tag="Oyun ara..."/>
                    </DockPanel>
                </Border>
            </DockPanel>
        </Border>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="0" x:Name="FilterColumn"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Background="{DynamicResource PanelBackgroundBrush}" 
                    BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,1,0" Padding="15">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="FİLTRE SEÇENEKLERİ" Foreground="{DynamicResource MutedTextBrush}" 
                                   FontSize="12" FontWeight="Bold" Margin="0,0,0,15"/>

                        <TextBlock Text="Tür (Genre)" Foreground="{DynamicResource SecondaryTextBrush}" Margin="0,10,0,5"/>
                        <ComboBox ItemsSource="{Binding GenreList}" Style="{StaticResource ModernComboBox}" SelectedItem="{Binding SelectedGenre}" />

                        <TextBlock Text="Puan Durumu" Foreground="{DynamicResource SecondaryTextBrush}" Margin="0,15,0,5"/>
                        <ComboBox SelectedIndex="{Binding SelectedRatingIndex}" Style="{StaticResource ModernComboBox}">
                            <ComboBoxItem Content="Tümü"/>
                            <ComboBoxItem Content="⭐⭐⭐⭐ 4+ (Harika)"/>
                            <ComboBoxItem Content="⭐⭐⭐ 3+ (İyi)"/>
                            <ComboBoxItem Content="⭐⭐ 2+ (Orta)"/>
                        </ComboBox>

                        <TextBlock Text="Fiyat" Foreground="{DynamicResource SecondaryTextBrush}" Margin="0,15,0,5"/>
                        <ComboBox SelectedIndex="{Binding SelectedPriceIndex}" Style="{StaticResource ModernComboBox}">
                            <ComboBoxItem Content="Tümü"/>
                            <ComboBoxItem Content="Ücretsiz Oyunlar"/>
                            <ComboBoxItem Content="Ücretli Oyunlar"/>
                        </ComboBox>

                        <TextBlock Text="Sıralama" Foreground="{DynamicResource SecondaryTextBrush}" Margin="0,15,0,5"/>
                        <ComboBox SelectedIndex="{Binding SelectedSortIndex}" Style="{StaticResource ModernComboBox}">
                            <ComboBoxItem Content="Varsayılan"/>
                            <ComboBoxItem Content="📅 En Yeniler"/>
                            <ComboBoxItem Content="⭐ Puanı Yüksek"/>
                            <ComboBoxItem Content="💰 Fiyatı Düşük"/>
                        </ComboBox>

                        <Button Content="Temizle" Margin="0,30,0,0" Height="30"
                                Background="#E81123" Foreground="White" BorderThickness="0"
                                Command="{Binding ClearFiltersCommand}">
                            <Button.Resources>
                                <Style TargetType="Border">
                                    <Setter Property="CornerRadius" Value="5"/>
                                </Style>
                            </Button.Resources>
                        </Button>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="{Binding ResultCountText}" Foreground="{DynamicResource MutedTextBrush}" 
                           Margin="20,15,0,5" FontStyle="Italic"/>

                <ScrollViewer Grid.Row="1" Margin="10,0,10,0">
                    <ItemsControl ItemsSource="{Binding FilteredGames}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>

                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="10" Background="{DynamicResource CardBackgroundBrush}" 
                                        CornerRadius="10" Width="180">

                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="RenderTransformOrigin" Value="0.5, 0.5"/>
                                            <Setter Property="RenderTransform">
                                                <Setter.Value>
                                                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Trigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleX" To="1.05" Duration="0:0:0.2"/>
                                                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleY" To="1.05" Duration="0:0:0.2"/>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.EnterActions>
                                                    <Trigger.ExitActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleX" To="1" Duration="0:0:0.2"/>
                                                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.ScaleY" To="1" Duration="0:0:0.2"/>
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.ExitActions>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>

                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.3"/>
                                    </Border.Effect>

                                    <StackPanel>
                                        <Image Source="{Binding Poster}" Height="240" Stretch="UniformToFill" ClipToBounds="True"/>

                                        <TextBlock Text="{Binding Title}" Foreground="{DynamicResource PrimaryTextBrush}" 
                                                   FontSize="15" FontWeight="SemiBold" Margin="8,8,8,0" TextTrimming="CharacterEllipsis"/>

                                        <StackPanel Orientation="Horizontal" Margin="8,4">
                                            <TextBlock Text="{Binding Genre}" Foreground="{DynamicResource MutedTextBrush}" FontSize="11"/>
                                            <TextBlock Text=" • " Foreground="{DynamicResource MutedTextBrush}" FontSize="11"/>
                                            <TextBlock Text="{Binding Year}" Foreground="{DynamicResource MutedTextBrush}" FontSize="11"/>
                                        </StackPanel>

                                        <DockPanel Margin="8,0,8,10">
                                            <Border Background="{DynamicResource InputBackgroundBrush}" CornerRadius="4" Padding="4,2">
                                                <TextBlock Text="{Binding Rating}" Foreground="{DynamicResource AccentBrush}" FontWeight="Bold" FontSize="12"/>
                                            </Border>
                                            <TextBlock Text="{Binding PriceTag}" Foreground="{DynamicResource SecondaryTextBrush}" 
                                                       HorizontalAlignment="Right" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                        </DockPanel>

                                        <DockPanel Margin="8,0,8,10">
                                            <Button DockPanel.Dock="Right" Content="+" Width="30" Height="30" 
                                                    Margin="5,0,0,0"
                                                    Background="{DynamicResource InputBackgroundBrush}" 
                                                    Foreground="{DynamicResource AccentBrush}" 
                                                    BorderThickness="0" 
                                                    FontSize="20" FontWeight="Bold" Padding="0,0,0,2"
                                                    ToolTip="Listeye Ekle"
                                                    Tag="{Binding Id}" Click="btnAddToList_Click">
                                                <Button.Resources>
                                                    <Style TargetType="Border">
                                                        <Setter Property="CornerRadius" Value="5"/>
                                                    </Style>
                                                </Button.Resources>
                                            </Button>

                                            <Button Content="İncele" Height="30"
                                                    Background="{DynamicResource BorderBrush}" 
                                                    Foreground="{DynamicResource PrimaryTextBrush}" 
                                                    BorderThickness="0"
                                                    Tag="{Binding Id}" Click="btnReview_Click">
                                                <Button.Resources>
                                                    <Style TargetType="Border">
                                                        <Setter Property="CornerRadius" Value="5"/>
                                                    </Style>
                                                </Button.Resources>
                                            </Button>
                                        </DockPanel>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>

            <Border Grid.Column="2" Background="{DynamicResource PanelBackgroundBrush}" 
                    BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1,0,0,0" Padding="15">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Margin="0,0,0,20">
                        <TextBlock Text="EN İYİLER" Foreground="{DynamicResource AccentBrush}" 
                                   FontSize="14" FontWeight="Bold"/>
                        <TextBlock Text="Oyuncuların favorileri" Foreground="{DynamicResource MutedTextBrush}" 
                                   FontSize="11"/>
                    </StackPanel>

                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Hidden">
                        <ItemsControl ItemsSource="{Binding TopRatedGames}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Margin="0,0,0,15" Background="Transparent" Cursor="Hand">
                                        <DockPanel>
                                            <Border Width="50" Height="70" CornerRadius="5" Margin="0,0,10,0">
                                                <Border.Effect>
                                                    <DropShadowEffect BlurRadius="5" ShadowDepth="2" Opacity="0.3"/>
                                                </Border.Effect>
                                                <Border.Background>
                                                    <ImageBrush ImageSource="{Binding Poster}" Stretch="UniformToFill"/>
                                                </Border.Background>
                                            </Border>

                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="{Binding Title}" Foreground="{DynamicResource PrimaryTextBrush}" 
                                                           FontWeight="SemiBold" FontSize="13" TextTrimming="CharacterEllipsis" MaxWidth="150"/>

                                                <TextBlock Text="{Binding Genre}" Foreground="{DynamicResource MutedTextBrush}" 
                                                           FontSize="11" Margin="0,2,0,5"/>

                                                <Border Background="{DynamicResource InputBackgroundBrush}" 
                                                        CornerRadius="3" Padding="5,2" HorizontalAlignment="Left">
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="⭐" FontSize="10" Margin="0,0,3,0"/>
                                                        <TextBlock Text="{Binding Rating}" Foreground="{DynamicResource AccentBrush}" 
                                                                   FontWeight="Bold" FontSize="11"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </DockPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</UserControl>